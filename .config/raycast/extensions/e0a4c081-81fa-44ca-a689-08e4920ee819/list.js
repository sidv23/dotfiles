var ge=Object.create;var O=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var ye=Object.getOwnPropertyNames;var be=Object.getPrototypeOf,Pe=Object.prototype.hasOwnProperty;var q=t=>O(t,"__esModule",{value:!0});var k=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Se=(t,e)=>{q(t);for(var n in e)O(t,n,{get:e[n],enumerable:!0})},xe=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ye(e))!Pe.call(t,r)&&r!=="default"&&O(t,r,{get:()=>e[r],enumerable:!(n=me(e,r))||n.enumerable});return t},P=t=>xe(q(O(t!=null?ge(be(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var V=k(R=>{R.parse=R.decode=Re;R.stringify=R.encode=N;R.safe=_;R.unsafe=A;var G=typeof process!="undefined"&&process.platform==="win32"?`\r
`:`
`;function N(t,e){var n=[],r="";typeof e=="string"?e={section:e,whitespace:!1}:(e=e||{},e.whitespace=e.whitespace===!0);var s=e.whitespace?" = ":"=";return Object.keys(t).forEach(function(i,o,f){var l=t[i];l&&Array.isArray(l)?l.forEach(function(u){r+=_(i+"[]")+s+_(u)+`
`}):l&&typeof l=="object"?n.push(i):r+=_(i)+s+_(l)+G}),e.section&&r.length&&(r="["+_(e.section)+"]"+G+r),n.forEach(function(i,o,f){var l=B(i).join("\\."),u=(e.section?e.section+".":"")+l,a=N(t[i],{section:u,whitespace:e.whitespace});r.length&&a.length&&(r+=G),r+=a}),r}function B(t){return t.replace(/\1/g,"LITERAL\\1LITERAL").replace(/\\\./g,"").split(/\./).map(function(e){return e.replace(/\1/g,"\\.").replace(/\2LITERAL\\1LITERAL\2/g,"")})}function Re(t){var e={},n=e,r=null,s=/^\[([^\]]*)\]$|^([^=]+)(=(.*))?$/i,i=t.split(/[\r\n]+/g);return i.forEach(function(o,f,l){if(!(!o||o.match(/^\s*[;#]/))){var u=o.match(s);if(!!u){if(u[1]!==void 0){if(r=A(u[1]),r==="__proto__"){n={};return}n=e[r]=e[r]||{};return}var a=A(u[2]);if(a!=="__proto__"){var p=u[3]?A(u[4]):!0;switch(p){case"true":case"false":case"null":p=JSON.parse(p)}if(a.length>2&&a.slice(-2)==="[]"){if(a=a.substring(0,a.length-2),a==="__proto__")return;n[a]?Array.isArray(n[a])||(n[a]=[n[a]]):n[a]=[]}Array.isArray(n[a])?n[a].push(p):n[a]=p}}}}),Object.keys(e).filter(function(o,f,l){if(!e[o]||typeof e[o]!="object"||Array.isArray(e[o]))return!1;var u=B(o),a=e,p=u.pop(),h=p.replace(/\\\./g,".");return u.forEach(function(d,b,g){d!=="__proto__"&&((!a[d]||typeof a[d]!="object")&&(a[d]={}),a=a[d])}),a===e&&h===p?!1:(a[h]=e[o],!0)}).forEach(function(o,f,l){delete e[o]}),e}function J(t){return t.charAt(0)==='"'&&t.slice(-1)==='"'||t.charAt(0)==="'"&&t.slice(-1)==="'"}function _(t){return typeof t!="string"||t.match(/[=\r\n]/)||t.match(/^\[/)||t.length>1&&J(t)||t!==t.trim()?JSON.stringify(t):t.replace(/;/g,"\\;").replace(/#/g,"\\#")}function A(t,e){if(t=(t||"").trim(),J(t)){t.charAt(0)==="'"&&(t=t.substr(1,t.length-2));try{t=JSON.parse(t)}catch{}}else{for(var n=!1,r="",s=0,i=t.length;s<i;s++){var o=t.charAt(s);if(n)"\\;#".indexOf(o)!==-1?r+=o:r+="\\"+o,n=!1;else{if(";#".indexOf(o)!==-1)break;o==="\\"?n=!0:r+=o}}return n&&(r+="\\"),r.trim()}return t}});var H=k((Be,z)=>{"use strict";var U=require("fs"),W=require("os"),j=require("path");z.exports=function(t,e){typeof t!="string"&&(e=t,t=null);let n=Object.assign({cwd:process.cwd(),type:t},e),r;if(n.type==="global"?r=j.join(W.homedir(),".gitconfig"):r=j.resolve(n.cwd,".git/config"),!U.existsSync(r)){if(typeof n.type=="string")return null;r=j.join(W.homedir(),".config/git/config")}return U.existsSync(r)?r:null}});var ee=k((Je,Z)=>{"use strict";var C=require("fs"),we=require("os"),$=require("path"),M=require("util"),ve=V(),_e=H(),Q=t=>t?t.replace(/^~/,we.homedir()):"",m=(t,e)=>(typeof t=="function"&&(e=t,t=null),typeof e!="function"?m.promise(t):m.promise(t).then(n=>e(null,n)).catch(e));m.promise=t=>{let e=m.resolveConfigPath(t),n=M.promisify(C.readFile),r=M.promisify(C.stat);return e?r(e).then(()=>n(e,"utf8")).then(s=>(t&&t.include===!0&&(s=Y(s,$.resolve($.dirname(e)))),X(s,t))):Promise.resolve(null)};m.sync=t=>{let e=m.resolveConfigPath(t);if(e&&C.existsSync(e)){let n=C.readFileSync(e,"utf8");if(t&&t.include===!0){let r=$.resolve($.dirname(e));n=Y(n,r)}return X(n,t)}return{}};m.resolveConfigPath=t=>{typeof t=="string"&&(t={type:t});let e=Object.assign({cwd:process.cwd()},t),n=e.path?Q(e.path):_e(e.type);return n?$.resolve(e.cwd,n):null};m.resolve=t=>m.resolveConfigPath(t);m.expandKeys=t=>{for(let e of Object.keys(t)){let n=/(\S+) "(.*)"/.exec(e);if(!n)continue;let r=n[1];t[r]=t[r]||{},t[r][n[2]]=t[e],delete t[e]}return t};function X(t,e){let n=Object.assign({},e);t=t.replace(/\[(\S+) "(.*)"\]/g,(s,i,o)=>i&&o?`[${i} "${o.split(".").join("\\.")}"]`:s);let r=ve.parse(t);return n.expandKeys===!0?m.expandKeys(r):r}function Y(t,e){let n=t.split(`
`).filter(i=>i.trim()!==""),r=n.length,s=[];for(let i=0;i<r;i++){let o=n[i];if(o.indexOf("[include]")===0){let f=n[i+1].replace(/^\s*path\s*=\s*/,""),l=$.resolve(e,Q(f));s.push(C.readFileSync(l))}else s.push(o)}return s.join(`
`)}Z.exports=m});var se=k((Ve,ie)=>{"use strict";var te=require("url"),ne={};ie.exports=function(e){return ne[e]||(ne[e]=$e(e))};function $e(t){if(typeof t!="string"||!t.length||t.indexOf("git@gist")!==-1||t.indexOf("//gist")!==-1)return null;var e=te.parse(t);if(typeof e.path!="string"||!e.path.length||typeof e.pathname!="string"||!e.pathname.length)return null;!e.host&&/^git@/.test(t)===!0&&(e.host=te.parse("http://"+t).host),e.path=re(e.path),e.pathname=re(e.pathname),e.filepath=null,e.path.indexOf("repos")===0&&(e.path=e.path.slice(6));var n=e.path.split("/").filter(Boolean),r=n[2]==="blob";r&&!Ce(n[3])&&(e.branch=n[3],n.length>4&&(e.filepath=n.slice(4).join("/")));var s=t.indexOf("blob");s!==-1&&(e.blob=t.slice(s+5));var i=t.indexOf("tree");if(i!==-1){var o=i+5,f=t.slice(o),l=f.indexOf("/");l!==-1&&(f=f.slice(0,l)),e.branch=f}if(e.owner=Ae(n[0]),e.name=ke(n[1]),n.length>1&&e.owner&&e.name)e.repo=e.owner+"/"+e.name;else{var u=e.href.split(":");if(u.length===2&&e.href.indexOf("//")===-1){e.repo=e.repo||u[u.length-1];var a=e.repo.split("/");e.owner=a[0],e.name=a[1]}else{var p=e.href.match(/\/([^\/]*)$/);e.owner=p?p[1]:null,e.repo=null}if(e.repo&&(!e.owner||!e.name)){var h=e.repo.split("/");h.length===2&&(e.owner=h[0],e.name=h[1])}}return e.branch||(e.branch=n[2]||Oe(e.path,e),n.length>3&&(e.filepath=n.slice(3).join("/"))),e.host=e.host||"github.com",e.owner=e.owner||null,e.name=e.name||null,e.repository=e.repo,e}function Ce(t){return/^[a-f0-9]{40}$/i.test(t)}function Oe(t,e){var n=t.split("#"),r;return n.length>1&&(r=n[n.length-1]),!r&&e.hash&&e.hash.charAt(0)==="#"&&(r=e.hash.slice(1)),r||"master"}function re(t){return t.charAt(0)==="/"?t.slice(1):t}function ke(t){return t?t.replace(/^\W+|\.git$/g,""):null}function Ae(t){if(!t)return null;var e=t.indexOf(":");return e>-1?t.slice(e+1):t}});Se(exports,{default:()=>pe});var c=P(require("@raycast/api")),fe=P(require("react"));var y=P(require("@raycast/api")),w=P(require("react")),T=P(require("os")),v=P(require("path")),S=P(require("fs")),oe=P(require("util")),ae=P(require("child_process")),I=(0,oe.promisify)(ae.exec),Te=ee(),Le=se(),F=v.default.join(y.environment.supportPath,"cache.json"),E=class{constructor(){je(),this.repos=[];try{S.default.accessSync(F,S.default.constants.R_OK)}catch{return}let e=S.default.readFileSync(F).toString();if(e.length>0){let n=JSON.parse(e);this.repos=n.repos}}save(){let e=JSON.stringify(this,null,2)+`
`;S.default.writeFileSync(F,e)}setRepos(e){this.repos=e}clear(){this.repos=[],this.save()}};function Ge(t){return t.length>0&&t[0]==="~"?v.default.join((0,T.homedir)(),t.slice(1)):t}function ce(t){let e=v.default.normalize(t)+v.default.sep;return(e.indexOf((0,T.homedir)())===0?e.replace((0,T.homedir)()+v.default.sep,`~${v.default.sep}`):e).slice(0,-1)}function je(){S.default.mkdirSync(y.environment.supportPath,{recursive:!0})}async function Ie(){return{reposDir:y.preferences.repoScanPath?.value,maxDepth:y.preferences.repoScanDepth?.value??3,includeSubmodules:y.preferences.includeSubmodules?.value}}function le(t){let e=[],n=Te.sync({cwd:t,path:".git/config",expandKeys:!0});if(n.remote!=null)for(let r in n.remote){let s=n.remote[r],i=Le(s.url);i?.host&&i?.repo&&(e=e.concat({name:r,host:i?.host,url:`https://${i?.host}/${i?.repo}`}))}return e}function Fe(t){let e=[],n=[];return t.split(":").map(s=>{if(s=s.trim(),s.length===0)return;let i=Ge(s.trim());try{S.default.accessSync(i,S.default.constants.R_OK),e.push(i)}catch{n.push(s)}}),[e,n]}function D(t,e,n=!1){return n?e.filter(r=>S.default.existsSync(r)).map(r=>{let s=r;return{name:`${s.split("/").pop()??"unknown"}`,icon:"git-submodule-icon.png",fullPath:s}}):e.map(r=>{let s=r.replace("/.git","");return{name:s.split("/").pop()??"unknown",icon:"git-icon.png",fullPath:s}})}async function Ee(t,e,n){let r=new E,s=[];return await Promise.allSettled(t.map(async i=>{let o=`find -L ${i} -maxdepth ${e} -name .git -type d`,{stdout:f,stderr:l}=await I(o);if(l)return(0,y.showToast)(y.ToastStyle.Failure,"Find Failed",l),console.error(`error: ${l}`),[];let u=f.split(`
`).filter(h=>h),a=D(i,u,!1);if(n){let h=[];await Promise.allSettled(a.map(async b=>{let g=await De(b.fullPath);g.length>0&&(h=h.concat(g))}));let d=D(i,h,!0);s=s.concat(a.concat(d))}else s=s.concat(a);(await Ke(i,e)).forEach(function(h){s.findIndex(b=>b.fullPath===h.fullPath)===-1&&s.push(h)})})),s.sort((i,o)=>{let f=i.name.toLowerCase(),l=o.name.toLowerCase();return f<l?-1:f>l?1:0}),r.setRepos(s),r.save(),s}async function De(t){let{stdout:e}=await I(`grep "\\[submodule"  ${t+"/.gitmodules"} | sed "s%\\[submodule \\"%\${1%/.git}/%g" | sed "s/\\"]//g"`);return e.split(`
`).filter(s=>s).map(s=>`${t}${s}`)}async function Ke(t,e){let n=[],r=`find -L ${t} -maxdepth ${e} -name .git -type f`,{stdout:s,stderr:i}=await I(r);if(!i){let o=s.split(`
`).filter(l=>l),f=D(t,o,!1);n=n.concat(f),n.map(l=>l.icon="git-worktree-icon.png")}return n}function ue(t){let[e,n]=(0,w.useState)(),[r,s]=(0,w.useState)(),[i,o]=(0,w.useState)(!0),[f,l]=(0,w.useState)(!1),u=new E,a=!1,p=u.repos;function h(d,b){return d.filter(g=>g.name.toLocaleLowerCase().includes(b.toLowerCase()))}return(0,w.useEffect)(()=>{async function d(){if(!(a||f)){s(void 0);try{let g=await Ie();if(g.reposDir.length==0){s("Directories to scan has not been defined in settings");return}let[he,L]=Fe(g.reposDir);L.length>0&&s(`Director${L.length===1?"y":"ies"} not found: ${L}`);let de=await Ee(he,g.maxDepth,g.includeSubmodules);if(!a){let x=de,K=`${x.length} Repo${x.length!=1?"s":""}`;t&&t?.length>0&&(x=h(x,t),K=`${x.length} Repo${x.length!=1?"s":""} Found`),n({sectionTitle:K,repos:x}),l(!0)}}catch(g){a||s(g)}finally{a||o(!1)}}}let b=`${p.length} Repo${p.length!=1?"s":""}`;return t&&t.length>0&&(p=h(p,t),b=`${p.length} Repo${p.length!=1?"s":""} Found`),u.repos.length>0&&n({sectionTitle:b,repos:p}),f||d(),()=>{a=!0}},[t]),{response:e,error:r,isLoading:i}}function pe(){let[t,e]=(0,fe.useState)(),{response:n,error:r,isLoading:s}=ue(t);return r&&(0,c.showToast)(c.ToastStyle.Failure,"",r),_jsx(c.List,{onSearchTextChange:e,isLoading:s},_jsx(c.List.Section,{title:n?.sectionTitle},n?.repos?.map(i=>_jsx(c.List.Item,{key:i.fullPath,id:i.fullPath,title:i.name,icon:i.icon,accessoryTitle:ce(i.fullPath),keywords:[i.name],actions:_jsx(c.ActionPanel,null,_jsx(c.ActionPanel.Section,null,_jsx(c.OpenAction,{title:"Open in VSCode",icon:{fileIcon:"/Applications/Visual Studio Code.app"},target:i.fullPath,application:"Visual Studio Code"}),_jsx(c.OpenAction,{title:"Open in Terminal",icon:{fileIcon:"/Applications/iTerm.app"},target:i.fullPath,application:"iTerm"}),_jsx(c.OpenWithAction,{path:i.fullPath,shortcut:{modifiers:["cmd"],key:"o"}}),_jsx(c.OpenAction,{title:"Open in Finder",icon:{fileIcon:"/System/Library/CoreServices/Finder.app"},target:i.fullPath,application:"Finder",shortcut:{modifiers:["cmd"],key:"f"}})),_jsx(c.ActionPanel.Section,null,le(i.fullPath).map(o=>{let f;switch(o.name){case"origin":f={modifiers:["shift","cmd"],key:"o"};break;case"upstream":f={modifiers:["shift","cmd"],key:"u"};break;default:break}let l,u=o.host;switch(o.host){case"github.com":l={source:"github-icon.png",tintColor:c.Color.PrimaryText},u="GitHub";break;case"gitlab.com":l={source:"gitlab-icon.png",tintColor:c.Color.PrimaryText},u="GitLab";break;case"bitbucket.org":l={source:"bitbucket-icon.png",tintColor:c.Color.PrimaryText},u="Bitbucket";break;default:break}return o.host==="github.com"?_jsx(c.ActionPanel.Submenu,{title:`Open ${o.name} on ${u}`,key:`GitHub_${o.name}`,icon:l??c.Icon.Globe,shortcut:f},_jsx(c.OpenInBrowserAction,{title:"Code",key:`code ${o.name}`,url:o.url,icon:{source:"github-code-icon.png",tintColor:c.Color.PrimaryText},shortcut:{modifiers:["shift","cmd"],key:"c"}}),_jsx(c.OpenInBrowserAction,{title:"Issues",key:`issues ${o.name}`,url:`${o.url}/issues`,icon:{source:"github-issues-icon.png",tintColor:c.Color.PrimaryText},shortcut:{modifiers:["shift","cmd"],key:"i"}}),_jsx(c.OpenInBrowserAction,{title:"Pull Requests",key:`pulls ${o.name}`,url:`${o.url}/pulls`,icon:{source:"github-pulls-icon.png",tintColor:c.Color.PrimaryText},shortcut:{modifiers:["shift","cmd"],key:"p"}})):_jsx(c.OpenInBrowserAction,{title:`Open ${o.name} on ${u}`,key:`open remote ${o.name}`,url:o.url,shortcut:f,icon:l??c.Icon.Globe})}),_jsx(c.CopyToClipboardAction,{title:"Copy Path to Clipboard",content:i.fullPath,shortcut:{modifiers:["cmd"],key:"."}})))}))))}0&&(module.exports={});
/*!
 * git-config-path <https://github.com/jonschlinkert/git-config-path>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */
/*!
 * parse-git-config <https://github.com/jonschlinkert/parse-git-config>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */
/*!
 * parse-github-url <https://github.com/jonschlinkert/parse-github-url>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
