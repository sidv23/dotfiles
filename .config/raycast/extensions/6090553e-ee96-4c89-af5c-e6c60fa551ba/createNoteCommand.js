var k=Object.create;var u=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var x=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var d=r=>u(r,"__esModule",{value:!0});var L=(r,t)=>{for(var e in t)u(r,e,{get:t[e],enumerable:!0})},y=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of A(t))!b.call(r,a)&&(e||a!=="default")&&u(r,a,{get:()=>t[a],enumerable:!(i=w(t,a))||i.enumerable});return r},h=(r,t)=>y(d(u(r!=null?k(x(r)):{},"default",!t&&r&&r.__esModule?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),O=(r=>(t,e)=>r&&r.get(t)||(e=y(d({}),t,1),r&&r.set(t,e),e))(typeof WeakMap!="undefined"?new WeakMap:0);var R={};L(R,{default:()=>C});var p=require("@raycast/api");var o=require("@raycast/api");var n=require("@raycast/api"),m=h(require("path")),f=h(require("fs")),F=class{constructor(t,e,i){this.saved=!1;this.vaultPath=e,this.noteProps=t,this.openOnCreation=i}createNote(){if(this.noteProps.name==""){let e=(0,n.getPreferenceValues)();this.noteProps.name=e.prefNoteName}let t=this.buildNoteContent();if(this.saveNote(t),this.openOnCreation){let e="obsidian://open?path="+encodeURIComponent(m.default.join(this.vaultPath,this.noteProps.path,this.noteProps.name+".md"));(0,n.open)(e)}return this.saved}buildNoteContent(){let t="";if(this.noteProps.tags.length>0){t=`---
tags: [`;for(let e=0;e<this.noteProps.tags.length-1;e++)t+='"'+this.noteProps.tags[e]+'",';t+='"'+this.noteProps.tags.pop()+`"]
---
`}return t+=this.noteProps.content,t}async saveNote(t){let e=m.default.join(this.vaultPath,this.noteProps.path);if(f.default.existsSync(m.default.join(e,this.noteProps.name+".md"))){let i={title:"Override note",message:'Are you sure you want to override the note: "'+this.noteProps.name+'"?',icon:n.Icon.ExclamationMark};await(0,n.confirmAlert)(i)&&this.writeToFile(e,t)}else this.writeToFile(e,t)}writeToFile(t,e){try{try{f.default.mkdirSync(t,{recursive:!0})}catch{(0,n.showToast)({title:"Couldn't create directories for the given path:",message:t,style:n.Toast.Style.Failure});return}try{f.default.writeFileSync(m.default.join(t,this.noteProps.name+".md"),e)}catch{(0,n.showToast)({title:"Couldn't write to file:",message:t+"/"+this.noteProps.name+".md",style:n.Toast.Style.Failure});return}(0,n.showToast)({title:"Note created",style:n.Toast.Style.Success}),this.saved=!0}catch{(0,n.showToast)({title:"Something went wrong",message:" Maybe your vault, path or filename is not valid",style:n.Toast.Style.Failure})}}},N=F;function $(){let t=(0,o.getPreferenceValues)().prefPath;return t||""}function j(){let t=(0,o.getPreferenceValues)().prefTag;return t?[t]:[]}function E(){let r=(0,o.getPreferenceValues)(),t=r.tags,e=r.prefTag;if(!t)return e?[{name:e,key:e}]:[];let i=t.split(",").map(a=>({name:a.trim(),key:a.trim()})).filter(a=>!!a);return e&&i.push({name:e,key:e}),i}function I(){let t=(0,o.getPreferenceValues)().folderActions;return t?t.split(",").filter(i=>!!i).map(i=>i.trim()):[]}function g(r){let t=r.vaultPath,e=(0,o.getPreferenceValues)(),{pop:i}=(0,o.useNavigation)();function a(s,c=void 0){c!==void 0&&(s.path=c),new N(s,t,e.openOnCreate).createNote()&&i()}return _jsx(o.Form,{navigationTitle:"Create Note",actions:_jsx(o.ActionPanel,null,_jsx(o.Action.SubmitForm,{title:"Create",onSubmit:a}),I()?.map((s,c)=>_jsx(o.Action.SubmitForm,{title:"Create in "+s,onSubmit:P=>a(P,s),key:c,shortcut:{modifiers:["shift","cmd"],key:c.toString()}})))},_jsx(o.Form.TextField,{title:"Name",id:"name",placeholder:"Name of note"}),_jsx(o.Form.TextField,{title:"Path",id:"path",defaultValue:$(),placeholder:"path/to/note (optional)"}),_jsx(o.Form.TagPicker,{id:"tags",title:"Tags",defaultValue:j()},E()?.map(s=>_jsx(o.Form.TagPicker.Item,{value:s.name.toLowerCase(),title:s.name,key:s.key}))),_jsx(o.Form.TextArea,{title:"Content:",id:"content",placeholder:"Text"}))}var l=require("@raycast/api");function v(r){let t=r.vaults;return _jsx(l.List,null,t?.map(e=>_jsx(l.List.Item,{title:e.name,key:e.key,actions:_jsx(l.ActionPanel,null,_jsx(l.Action.Push,{title:"Select Vault",target:r.target(e)}))})))}var S=require("@raycast/api");var V=h(require("path"));function M(r){let t=r.split(V.default.sep).filter(e=>{if(e!="")return e}).pop();return t||"Default Vault Name (check your path preferences)"}function T(){return(0,S.getPreferenceValues)().vaultPath.split(",").map(e=>({name:M(e.trim()),key:e.trim(),path:e.trim()})).filter(e=>!!e)}function C(){let r=T();if(r.length>1)return _jsx(v,{vaults:r,target:t=>_jsx(g,{vaultPath:t.path})});if(r.length==1)return _jsx(g,{vaultPath:r[0].path});(0,p.showToast)({title:"Path Error",message:"Something went wrong with your vault path. There are no paths to select from.",style:p.Toast.Style.Failure})}module.exports=O(R);0&&(module.exports={});
