var Y=Object.create;var y=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var G=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var L=n=>y(n,"__esModule",{value:!0});var Z=(n,e)=>{for(var t in e)y(n,t,{get:e[t],enumerable:!0})},T=(n,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of B(e))!K.call(n,i)&&(t||i!=="default")&&y(n,i,{get:()=>e[i],enumerable:!(o=z(e,i))||o.enumerable});return n},l=(n,e)=>T(L(y(n!=null?Y(G(n)):{},"default",!e&&n&&n.__esModule?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n),tt=(n=>(e,t)=>n&&n.get(e)||(t=T(L({}),e,1),n&&n.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var rt={};Z(rt,{default:()=>W});var x=require("@raycast/api");var k=require("@raycast/api"),C=l(require("fs")),V=l(require("path"));function g(n){let e=(0,k.getPreferenceValues)(),t="";try{t=C.default.readFileSync(n.path,"utf8")}catch{t="Couldn't read file. Did you move, delete or rename the file?"}if(e.removeYAML){let o=t.match(/---(.|\n)*?---/gm);o&&(t=t.replace(o[0],""))}if(e.removeLatex){let o=t.matchAll(/\$\$(.|\n)*?\$\$/gm);for(let s of o)t=t.replace(s[0],"");let i=t.matchAll(/\$(.|\n)*?\$/gm);for(let s of i)t=t.replace(s[0],"")}return e.removeLinks&&(t=t.replaceAll("![[",""),t=t.replaceAll("[[",""),t=t.replaceAll("]]","")),t}function et(n){let e=n.split(V.default.sep).filter(t=>{if(t!="")return t}).pop();return e||"Default Vault Name (check your path preferences)"}function w(){return(0,k.getPreferenceValues)().vaultPath.split(",").map(t=>({name:et(t.trim()),key:t.trim(),path:t.trim()})).filter(t=>!!t)}var p=require("@raycast/api"),v=require("react"),_=l(require("fs"));var I=require("@raycast/api"),A=l(require("fs")),O=l(require("path")),R=class{constructor(e){this.vaultPath=e}loadNotes(){let e=[],t=this.getFiles(),o=0;for(let i of t){let h=i.split("/").pop(),P="default";h&&(P=h.split(".md")[0]);let X={title:P,key:++o,path:i};e.push(X)}return e}getFiles(){let e=this.prefExcludedFolders();return this.getFilesHelp(this.vaultPath,e,[])}getFilesHelp(e,t,o){let i=A.default.readdirSync(e);o=o||[];for(let s of i)A.default.statSync(e+"/"+s).isDirectory()&&!s.includes(".obsidian")?o=this.getFilesHelp(e+"/"+s,t,o):s.endsWith(".md")&&s!==".md"&&!e.includes(".obsidian")&&this.isValidFile(e,t)&&o.push(O.default.join(e,"/",s));return o}isValidFile(e,t){for(let o of t)if(e.includes(o))return!1;return!0}prefExcludedFolders(){let t=(0,I.getPreferenceValues)().excludedFolders;if(t){let o=t.split(",");for(let i=0;i<o.length;i++)o[i]=o[i].trim();return o}else return[]}},D=R;var u=require("@raycast/api"),M=require("react");var r=require("@raycast/api"),E=l(require("fs")),m=l(require("react"));var c=require("@raycast/api"),$=l(require("fs"));function j(n){let e=n.note,{pop:t}=(0,c.useNavigation)();function o(i){$.default.appendFileSync(e.path,`
`+i.content),(0,c.showToast)({title:"Added text to note",style:c.Toast.Style.Success}),t()}return _jsx(c.Form,{navigationTitle:"Add text to: "+e.title,actions:_jsx(c.ActionPanel,null,_jsx(c.Action.SubmitForm,{title:"Submit",onSubmit:o}))},_jsx(c.Form.TextArea,{title:`Add text to:
`+e.title,id:"content",placeholder:"Text"}))}var a=require("@raycast/api"),f=l(require("fs"));function F(n){f.default.existsSync(a.environment.supportPath+"/data.json")||f.default.writeFileSync(a.environment.supportPath+"/data.json","[]");let e=f.default.readFileSync(a.environment.supportPath+"/data.json","utf8"),t=JSON.parse(e),o=t.filter(i=>i.vaultPath==n);if(o.length==0){let i={vaultPath:n,pinnedNotes:[]};return t.push(i),f.default.writeFileSync(a.environment.supportPath+"/data.json",JSON.stringify(t)),{vault:i,pinnedNotes:i.pinnedNotes,data:t}}else return{vault:o[0],pinnedNotes:o[0].pinnedNotes,data:t}}function S(n,e){let t=F(e),o=t.pinnedNotes.filter(s=>s.key!==n.key);t.vault.pinnedNotes=o;let i=t.data.findIndex(s=>s.vaultPath==e);return t.data[i]=t.vault,f.default.writeFileSync(a.environment.supportPath+"/data.json",JSON.stringify(t.data)),(0,a.showToast)({title:"Note Unpinned",message:"'"+n.title+"' unpinned successfully.",style:a.Toast.Style.Success}),o}function N(n,e){return F(e).pinnedNotes.filter(o=>o.key==n.key).length!==0}function U(n,e){let t=F(e);if(N(n,e)){(0,a.showToast)({title:"Already Pinned",message:"'"+n.title+"' is already pinned.",style:a.Toast.Style.Failure});return}t.vault.pinnedNotes.push(n);let o=t.data.findIndex(i=>i.vaultPath==e);t.data[o]=t.vault,f.default.writeFileSync(a.environment.supportPath+"/data.json",JSON.stringify(t.data)),(0,a.showToast)({title:"Note Pinned",message:"'"+n.title+"' pinned successfully.",style:a.Toast.Style.Success})}async function nt(n){let t=(0,r.getPreferenceValues)().appendPrefix;t===void 0&&(t="");try{let o=await(0,r.getSelectedText)();o.trim()==""?(0,r.showToast)({title:"No text selected",message:"Make sure to select some text.",style:r.Toast.Style.Failure}):(E.default.appendFileSync(n.path,`
`+t+o),(0,r.showToast)({title:"Added selected text to note",style:r.Toast.Style.Success}))}catch{(0,r.showToast)({title:"Couldn't copy selected text",message:"Maybe you didn't select anything.",style:r.Toast.Style.Failure})}}function ot(n){let e=n.note,t=g(e);return _jsx(r.Detail,{markdown:t,actions:_jsx(r.ActionPanel,null,_jsx(r.Action.Open,{title:"Open in Obsidian",target:"obsidian://open?path="+encodeURIComponent(e.path)}))})}function J(n){let e=n.note,[t,o]=(0,m.useState)(N(e,n.vaultPath));return _jsx(m.default.Fragment,null,_jsx(r.Action.Push,{title:"Append to Note",target:_jsx(j,{note:e}),shortcut:{modifiers:["opt"],key:"a"},icon:r.Icon.Pencil}),_jsx(r.Action,{title:"Append Selected Text to Note",shortcut:{modifiers:["opt"],key:"s"},onAction:()=>{nt(e)},icon:r.Icon.Pencil}),_jsx(r.Action.CopyToClipboard,{title:"Copy Note Content",content:g(e),shortcut:{modifiers:["opt"],key:"c"}}),_jsx(r.Action.Paste,{title:"Paste Note Content",content:g(e),shortcut:{modifiers:["opt"],key:"v"}}),_jsx(r.Action.CopyToClipboard,{title:"Copy Markdown Link",icon:r.Icon.Link,content:`[${e.title}](obsidian://open?path=${encodeURIComponent(e.path)})`,shortcut:{modifiers:["opt"],key:"l"}}),_jsx(r.Action.CopyToClipboard,{title:"Copy Obsidian URI",icon:r.Icon.Link,content:`obsidian://open?path=${encodeURIComponent(e.path)}`,shortcut:{modifiers:["opt"],key:"u"}}),_jsx(r.Action,{title:t?"Unpin Note":"Pin Note",shortcut:{modifiers:["opt"],key:"p"},onAction:()=>{t?(S(e,n.vaultPath),o(!t),n.onPin()):(U(e,n.vaultPath),o(!t),n.onPin())},icon:t?r.Icon.XmarkCircle:r.Icon.Pin}))}function H(n){let e=n.note,o=(0,r.getPreferenceValues)().primaryAction,i=_jsx(r.Action.Push,{title:"Quick Look",target:_jsx(ot,{note:e,vaultPath:n.vaultPath}),icon:r.Icon.Eye}),s=_jsx(r.Action.Open,{title:"Open in Obsidian",target:"obsidian://open?path="+encodeURIComponent(e.path)});return o=="quicklook"?_jsx(m.default.Fragment,null,i,s):o=="obsidian"?_jsx(m.default.Fragment,null,s,i):_jsx(m.default.Fragment,null,i,s)}function it(n){let e=n.note,[t,o]=(0,M.useState)(N(e,n.vaultPath)),i=function(){o(!t)};return _jsx(u.List.Item,{title:e.title,accessories:[{text:t?"\u2B50\uFE0F":""}],detail:_jsx(u.List.Item.Detail,{markdown:g(e)}),actions:_jsx(u.ActionPanel,null,_jsx(H,{note:e,vaultPath:n.vaultPath}),_jsx(J,{note:e,vaultPath:n.vaultPath,onPin:i}))})}function Q(n){let e=n.notes,t=n.action,o=e===void 0;e!==void 0&&(o=e.length==0),n.isLoading!==void 0&&(o=n.isLoading);let i=(0,u.getPreferenceValues)();return _jsx(u.List,{isLoading:o,isShowingDetail:i.showDetail},e?.map(s=>_jsx(it,{note:s,vaultPath:n.vaultPath,key:s.key})))}function b(n){function e(s){return _jsx(p.Action,{title:"Unpin Note",shortcut:{modifiers:["opt","cmd"],key:"u"},onAction:()=>{let h=S(s,n.vaultPath)},icon:p.Icon.XmarkCircle})}let t=n.vaultPath,[o,i]=(0,v.useState)([]);return(0,v.useEffect)(()=>{async function s(){try{await _.default.promises.access(t+"/.");let P=new D(t).loadNotes();i(P)}catch{(0,p.showToast)({title:"The path set in preferences doesn't exist",message:"Please set a valid path in preferences",style:p.Toast.Style.Failure})}}s()},[]),_jsx(Q,{notes:o,vaultPath:n.vaultPath,action:e})}var d=require("@raycast/api");function q(n){let e=n.vaults;return _jsx(d.List,null,e?.map(t=>_jsx(d.List.Item,{title:t.name,key:t.key,actions:_jsx(d.ActionPanel,null,_jsx(d.Action.Push,{title:"Select Vault",target:n.target(t)}))})))}function W(){let n=w();if(n.length>1)return _jsx(q,{vaults:n,target:e=>_jsx(b,{vaultPath:e.path})});if(n.length==1)return _jsx(b,{vaultPath:n[0].path});(0,x.showToast)({title:"Path Error",message:"Something went wrong with your vault path. There are no paths to select from.",style:x.Toast.Style.Failure})}module.exports=tt(rt);0&&(module.exports={});
